% NON PARAMETRIC MAGNITUDE
%
% Plot curve(s) with non parametric magnitude.
%
% 1.Distance vs logA0 East Anatolian Fault Zone vs California
% 2.Station's Correction
%
% This script generates FIGURE 9 (and 1 Supp Figure) of the DataPaper published in Earth Science System Data:
% A high-quality data set for seismological studies in the East Anatolian Fault Zone, TÃ¼rkiye
% by L. Colavitti, D. Bindi, G. Tarchini, D. Scafidi, M. Picozzi and D. Spallarossa
%
% Leonardo Colavitti - 23 September 2024
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Start Clock
tic;

clf; clc; clear; close all;

delete Hypo_A0.pdf
delete Stats_Corr.pdf

% California Curve [RED]
DIST_CAL = 0:1:150;

% Formula Hutton and Boore, 1987
A0_HB = NaN(size(DIST_CAL)); % Pre-Allocation

A0_HB(DIST_CAL > 0) = -1.11 * log10(DIST_CAL(DIST_CAL > 0) / 100) - 0.00189...
                       * (DIST_CAL(DIST_CAL > 0) - 100) - 3;

A0 = [-1.07244174898789, -1.35966885608513, -1.7160981199827, -1.98892830272993,...
      -2.13590773622714, -2.25363683689613, -2.35916366269252,-2.44766474104661,...
      -2.53240943860632, -2.61021249040695, -2.66528693249829,-2.71432473016411,...
      -2.76920664624866, -2.8191669249593,  -2.86747402825801,-2.91830902407577,...
      -2.94483049442765, -2.97215897437123, -2.99695095801442,-3.02269154981402,...
      -3.05424871270596, -3.08327063753436, -3.09998195213348,-3.10103337983401,...
      -3.1048308569975,  -3.12338149725456, -3.14040055466825,-3.14893211133948,...
      -3.16393664924174, -3.18257493288475, -3.19793731020898,-3.20847655774353,...
      -3.22572956384246, -3.2403844942238,  -3.25089747760466,-3.26015283312212,...
      -3.27195727105306];

DIST = [1,  6, 12, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61, 65, 69, 73, 77,...
       81, 85, 89, 93, 97,101,105,109,113,117,121,125,129,133,137,141,145,150];

figure(1)
hold on
box on
grid on
ax1 = gca;
ax1.XLim = [-5 160];
plot(DIST_CAL,A0_HB,'r-','LineWidth',2);
plot(DIST,A0,'b-','LineWidth',2);

xlabel('Hypocentral Distance [km]','FontName','Arial','FontSize',12,'FontWeight','Bold')
ylabel('log_{10} A_{0}','FontName','Arial','FontSize',12,'FontWeight','Bold')
legend('Southern California','East Anatolian Fault Zone')

% Print the figure as PDF
fig1_hz = 20;
fig1_vt = 15;

% Fit figure to the page
set(gcf,'PaperUnits','centimeters','PaperSize',[fig1_hz fig1_vt],'PaperPosition',[0, 0, fig1_hz, fig1_vt])

%%% SAVE PDF IMAGE %%%
% Print in PDF
% print('Hypo_A0', '-dpdf', '-r600'); % Save as PDF with resolution (dpi)

%%% STATIONS CORRECTION %%%

Stat_Corr = [-0.849288758057765, -0.838799091298206, -0.828149431046082, -0.695961403214851, ...
             -0.695136842042812, -0.686259618856793, -0.678735287634412, -0.643103592526532, ...
             -0.632572699332149, -0.616848348468136, -0.615929008218723, -0.599854055894537, ...
             -0.577064079340964, -0.573422402339656, -0.550352513003166, -0.530478498027957, ...
             -0.525216711589744, -0.517531256303805, -0.506697472391666, -0.500642196887164, ...
             -0.496082823179125, -0.47684429746238,  -0.461841355629992, -0.452538801611707, ...
             -0.439717077998777, -0.429460296449397, -0.428530096490171, -0.428149832464533, ...
             -0.424181580981163, -0.415251017088309, -0.407548482796391, -0.400643482113054, ...
             -0.373994820951539, -0.373534417136845, -0.364665936016693, -0.363012624449041, ...
             -0.362838124611088, -0.358195725074467, -0.349150645007224, -0.347582811929405, ...
             -0.346869176836675, -0.346745531897132, -0.34404875746055,  -0.342086070135582, ...
             -0.336016231954502, -0.334294116415982, -0.310035464923701, -0.307747036707578, ...
             -0.301997796595058, -0.297906382005004, -0.285171356083197, -0.28468562735604, ...
             -0.270245797263678, -0.264834222038489, -0.242681250584274, -0.234210463310848, ...
             -0.231145562865936, -0.231145499047921, -0.224603718265941, -0.222371191915687, ...
             -0.216384807893963, -0.212150728223175, -0.211212848443714, -0.208456357367325, ...
             -0.207735416167859, -0.199776096058686, -0.184481183745164, -0.183723633168479, ...
             -0.183000577400741, -0.181166088363252, -0.17048224188591,  -0.168717989544673, ...
             -0.163255012474824, -0.158969486583777, -0.15439625988598,  -0.153189213015068, ...
             -0.150276612265166, -0.148366090617709, -0.147300814479259, -0.14497643658499, ...
             -0.137689683164737, -0.130716803703082, -0.126657329288223, -0.122566480955865, ...
             -0.118543758481559, -0.114596724613206, -0.109745495168774, -0.107174390381625, ...
             -0.0988983487934995,-0.0904613384531237,-0.0729147574438836,-0.0720267235498826, ...
             -0.0660707376188467,-0.0601779682845768,-0.0583929394414169,-0.0566785533889234, ...
             -0.0553173512212902,-0.0513869119469749,-0.0428366879192854,-0.03869080467295, ...
             -0.0384782819739024,-0.0366170405007334,-0.0365969808840298,-0.0324676716303086, ...
             -0.0242882977699466,-0.0212680707941692,-0.0183802674061267,-0.00839212742512532,...
             -0.00811707154494784,-0.00289276474188157,0.00295928277405648,0.0052628516701642,...
             0.00620198848549205,0.00620358071471469,0.00877461235249192,0.0087782664093417, ...
             0.011691836391197, 0.0166375770380669, 0.0214388556815413, 0.0247094031716416, ...
             0.0248957280475788, 0.0312847444541779, 0.0330758320689143, 0.0399680670192867, ...
             0.0464799939800418, 0.0487093753384754, 0.0520482637271385, 0.0566170898316285, ...
             0.060909158455896, 0.0662909062524745, 0.0775292606476277, 0.0843517922575846, ...
             0.086723863097617, 0.089127000696094,0.0914509207466375, 0.0946282655528631, ...
             0.101812393503221, 0.111676538332721, 0.115541109877873, 0.1163821545454, ...
             0.117466047825659, 0.123046034796457,0.125497998266829, 0.131267865163378, ...
             0.131780920397995, 0.134355442898986, 0.140155422965179, 0.153331800060958, ...
             0.154901686198208,0.163013963909938, 0.173539757208428, 0.179063468542586, ...
             0.18945645357814, 0.192258167033963, 0.192815242274543, 0.203701314273796, ...
             0.204198725879953, 0.209346420506764, 0.212604910600048, 0.213775551380898, ...
             0.215673532764599, 0.217126015011859, 0.220159431216932, 0.226639391116062, ...
             0.227400924287553, 0.229595298494826, 0.232414958077419, 0.239160907036391, ...
             0.240652229548737, 0.241779678096335, 0.24579968513159, 0.249183588681996, ...
             0.256413857464525, 0.257575743555604,0.261113487369074, 0.26159443946746, ...
             0.262042675518283, 0.262582514436164,0.264618205845243, 0.264930351072025, ...
             0.26820168714931, 0.274520275439279, 0.279547728485294, 0.282431924017174, ...
             0.284092514863548,0.285616846699685,0.29162178187552,0.294416033158367,...
             0.298265697663852,0.298738428559196,0.302577807229145,0.302731213969163,...
             0.303005433541663,0.303849986908804,0.304000843408475,0.305024492314109,...
             0.306726816797208,0.30935164030942,0.311650796042112,0.317998568059037,...
             0.320256898164109,0.322828971716691,0.334323182840321,0.339577128288167,...
             0.355953374485228,0.356817774407436,0.360668497063733,0.363389340798482,...
             0.363948601619979,0.365143568236916,0.366587679754642,0.368531010165884,...
             0.369361953572078,0.37244406734428,0.377775256954098,0.380724887488381,...
             0.382541154733227,0.386690364769072,0.394084799081365,0.404317437772049,...
             0.405631474410865,0.408110942522832,0.419111920426747,0.423237416270696,...
             0.432777009320761,0.437885635250922,0.464031096999461,0.468666769384074,...
             0.4714685399287,0.472607904575625,0.485874757153239,0.496698558106326,...
             0.502225982466824,0.511075995066596,0.542611873450156,0.546139130818289,...
             0.651084161271056,0.967938666633735];

figure(2)
hold on
box on
grid on
ax2 = gca;
ax2.XTick = 0:25:250;
plot(Stat_Corr,'k.','MarkerSize',8)

xlabel('# Stations','FontName','Arial','FontSize',12,'FontWeight','Bold')
ylabel('Station Correction','FontName','Arial','FontSize',12,'FontWeight','Bold')

% Print the figure as PDF
fig2_hz = 20;
fig2_vt = 15;

% Fit figure to the page
set(gcf,'PaperUnits','centimeters','PaperSize',[fig2_hz fig2_vt],'PaperPosition',[0, 0, fig2_hz, fig2_vt])

%%% SAVE PDF IMAGE %%%
% Print in PDF
% print('Stats_Corr', '-dpdf', '-r600'); % Save as PDF with resolution (dpi)

% End Clock
toc;
